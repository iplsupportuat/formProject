*       *********************************************************
*       *                                                         
*       * 17/06/2004            ADMENU.MPR              15:30:12  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * IPL Research Ltd.                                       
*       *                                                         
*       * Copyright (C) 2004 IPL Research Ltd.                    
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

SET SYSMENU TO
SET SYSMENU AUTOMATIC

DEFINE PAD _19h0x89f1 OF _MSYSMENU PROMPT "\<System" COLOR SCHEME 3 ;
	KEY ALT+S, ""
DEFINE PAD _19h0x89f2 OF _MSYSMENU PROMPT "\<Admin" COLOR SCHEME 3 ;
	KEY ALT+A, ""
DEFINE PAD _19h0x89f3 OF _MSYSMENU PROMPT "\<Codes" COLOR SCHEME 3 ;
	KEY ALT+C, ""
DEFINE PAD Utilities OF _MSYSMENU PROMPT "\<Utilities" COLOR SCHEME 3 ;
	KEY ALT+U, ""
DEFINE PAD _19h0x89f4 OF _MSYSMENU PROMPT "\<Help" COLOR SCHEME 3 ;
	KEY ALT+H, ""
ON PAD _19h0x89f1 OF _MSYSMENU ACTIVATE POPUP system
ON PAD _19h0x89f2 OF _MSYSMENU ACTIVATE POPUP administra
ON PAD _19h0x89f3 OF _MSYSMENU ACTIVATE POPUP codes
ON PAD Utilities OF _MSYSMENU ACTIVATE POPUP utilities
ON PAD _19h0x89f4 OF _MSYSMENU ACTIVATE POPUP help

DEFINE POPUP system MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF system PROMPT "Select \<System ..." ;
	SKIP FOR oapp.skip
DEFINE BAR 2 OF system PROMPT "Select \<Company" ;
	SKIP FOR oapp.skip
DEFINE BAR 3 OF system PROMPT "\-"
DEFINE BAR 4 OF system PROMPT "Quit" ;
	KEY CTRL+Q, "CTRL+Q" ;
	SKIP FOR oapp.skip
ON SELECTION BAR 1 OF system oApp.SelectSystem()
ON SELECTION BAR 2 OF system oApp.SelectCompany()
ON SELECTION BAR 4 OF system ;
	DO _19h0x89f5 ;
	IN LOCFILE("\HRIS6\ADMENU" ,"MPX;MPR|FXP;PRG" ,"WHERE is ADMENU?")

DEFINE POPUP administra MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF administra PROMPT "\<New Company" ;
	SKIP FOR oApp.skip or wexist('FRMCOMP') 
DEFINE BAR 2 OF administra PROMPT "Company \<Information" ;
	KEY CTRL+I, "CTRL+I" ;
	SKIP FOR oApp.skip or wexist('FRMCOMP') 
DEFINE BAR 3 OF administra PROMPT "\<Delete Company" ;
	SKIP FOR oApp.skip or wexist('FRMCOMP') 
DEFINE BAR 4 OF administra PROMPT "\<Transfer/Remove Terminated Employee"
DEFINE BAR 5 OF administra PROMPT "\-"
DEFINE BAR 6 OF administra PROMPT "\<Change Administration Password" ;
	SKIP FOR oApp.skip or  wexist('frmadgrp')  or wexist('FRMCOMP')
DEFINE BAR 7 OF administra PROMPT "\<Group Administration" ;
	SKIP FOR oApp.skip  or wexist('frmadgrp')  or wexist('FRMCOMP')
DEFINE BAR 8 OF administra PROMPT "\-"
DEFINE BAR 9 OF administra PROMPT "\<Access Control Report" ;
	SKIP FOR oApp.skip  or wexist('frmadgrp')  or wexist('FRMCOMP')
DEFINE BAR 10 OF administra PROMPT "\<Security Log" ;
	SKIP FOR oApp.skip  or wexist('frmadgrp')  or wexist('FRMCOMP')
DEFINE BAR 11 OF administra PROMPT "Audit \<Log Report" ;
	SKIP FOR oApp.skip  or wexist('frmadgrp')  or wexist('FRMCOMP')
ON SELECTION BAR 1 OF administra DO FORM FRMCOMP WITH 'ADD'
ON SELECTION BAR 2 OF administra DO FORM FRMCOMP WITH 'MODIFY'
ON SELECTION BAR 3 OF administra ;
	DO _19h0x89f6 ;
	IN LOCFILE("\HRIS6\ADMENU" ,"MPX;MPR|FXP;PRG" ,"WHERE is ADMENU?")
ON SELECTION BAR 4 OF administra DO FORM FRMTRTRM
ON SELECTION BAR 6 OF administra DO FORM FRMADMIN
ON SELECTION BAR 7 OF administra DO FORM FRMADGRP
ON SELECTION BAR 9 OF administra do programs\prgacc
ON SELECTION BAR 10 OF administra DO FORM FRMAUDTS
ON SELECTION BAR 11 OF administra DO FORM FRMAUDIT

DEFINE POPUP codes MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF codes PROMPT "Maintenance" ;
	KEY CTRL+C, "CTRL+C" ;
	SKIP FOR goUser.aCode = 'X' or oApp.skip
DEFINE BAR 2 OF codes PROMPT "\-"
DEFINE BAR 3 OF codes PROMPT "\<Print ..." ;
	SKIP FOR goUser.aCode = 'X' or oApp.skip
ON SELECTION BAR 1 OF codes DO FORM FCODE
ON SELECTION BAR 3 OF codes DO FORM FPRTCODE

DEFINE POPUP utilities MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF utilities PROMPT "\<ToolBar"
ON SELECTION BAR 1 OF utilities ;
	DO _19h0x89f7 ;
	IN LOCFILE("\HRIS6\ADMENU" ,"MPX;MPR|FXP;PRG" ,"WHERE is ADMENU?")

DEFINE POPUP help MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF help PROMPT "\<Help" ;
	SKIP FOR !glHelp
DEFINE BAR 2 OF help PROMPT "\-"
DEFINE BAR 3 OF help PROMPT "\<About AD System"
ON SELECTION BAR 1 OF help HELP
ON SELECTION BAR 3 OF help DO FORM FRMABOUT


*       *********************************************************
*       *                                                         
*       *                 Cleanup Code & Procedures               
*       *                                                         
*       *********************************************************
*

*-- Change title bar of main Visual FoxPro windows
MODIFY WINDOW SCREEN TITLE gcSysName

RELEASE BAR 1 OF WINDOW

SET MARK OF BAR gnToolbarNum OF Utilities TO (TYPE('gcTool') = 'O')

*-- Refresh Main Toolbar
IF TYPE('gcTool') = 'O'
	gcTool.REFRESH()
ENDIF

IF glHelp
	SET HELP TO HELP\IPL-HRIS.HLP
ENDIF


*       *********************************************************
*       *                                                         
*       * _19H0X89F5  ON SELECTION BAR 4 OF POPUP system          
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  ADMENU.MPR,            Record:    8         
*       * Called By:  ON SELECTION BAR 4 OF POPUP system          
*       * Prompt:     Quit                                        
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _19h0x89f5
IF !oApp.CanOpenForm()
	RETURN .F.
ENDIF
oApp.CloseAllForm()
glEndSyst = .t.
CLEAR EVENTS
SET SYSMENU TO DEFAULT


*       *********************************************************
*       *                                                         
*       * _19H0X89F6  ON SELECTION BAR 3 OF POPUP administra      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  ADMENU.MPR,            Record:   13         
*       * Called By:  ON SELECTION BAR 3 OF POPUP administra      
*       * Prompt:     Delete Company                              
*       * Snippet:    2                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _19h0x89f6
******---------- Load Syscomp ------------------**********

lcSQL = [ SELECT C_COMPNO, C_COMPNAME FROM ] + gcSysCompDb + [..SysComp ] + ;
		[ WHERE C_CompNo <> ] + convertTerm(gcCompNo)

IF SQLEXEC(gnConnHandle, lcSQL, 'aSysComp') < 0
	DO ErrHand WITH ERROR(), MESSAGE(), MESSAGE(1), LINENO(), PROGRAM()
	RETURN .F.
ENDIF

IF RECCOUNT('aSysComp') = 0
	=MESSAGEBOX([No extra company to be deleted ! ], 64, [Delete Company])
ELSE
	SELECT aSysComp
	= CURSORSETPROP('Buffering', 5)

	DO FORM FRMDELCO
ENDIF



*       *********************************************************
*       *                                                         
*       * _19H0X89F7  ON SELECTION BAR 1 OF POPUP utilities       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  ADMENU.MPR,            Record:   30         
*       * Called By:  ON SELECTION BAR 1 OF POPUP utilities       
*       * Prompt:     ToolBar                                     
*       * Snippet:    3                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _19h0x89f7
BarNum = Bar()
lMrkBar = MRKBAR('Utilities', BarNum)

IF lMrkBar
   IF type('gcTool') = 'O'
      release gcTool
   ENDIF
ELSE
   PUBLIC gcTool
   gcTool = createobject('tbrmain')
   gcTool.Show()
ENDIF

SET MARK OF BAR BarNum OF Utilities TO !lMRKBAR
